!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.simpleMDParser=t():e.simpleMDParser=t()}(this,(()=>(()=>{"use strict";var e={d:(t,l)=>{for(var n in l)e.o(l,n)&&!e.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:l[n]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};async function l({str:e,url_callback:t,render_tag:l}){if("string"!=typeof e)return"";const n=async(e,l)=>{try{return"function"==typeof t&&(e=await Promise.resolve(t(e,l))),new URL(e),e}catch(e){return!1}};"function"!=typeof l&&(l=(e,t,l)=>{switch(e){case"b":return`<b>${l}</b>`;case"i":return`<i>${l}</i>`;case"a":return`<a href="${encodeURI(t.href)}">${l.replace(/<\/a>/gim,"&lt;/a>")}</a>`;case"img":return`<img src="${encodeURI(t.src)}" alt="${t.alt.replace(/\\/gim,"&#8726;").replace(/"/gim,"&quot;")}" />`;case"code":return`<code>${l.replace(/<\/code>/gim,"&lt;/code>")}</code>`;case"pre":return`<pre><code>${l.replace(/<\/code>/gim,"&lt;/code>").replace(/<\/pre>/gim,"&lt;/pre>")}</code></pre>`;case"ul":return`<ul>${l.map((e=>`<li>${e}</li>`)).join("")}</ul>`;case"ol":return`<ol>${l.map((e=>`<li>${e}</li>`)).join("")}</ol>`;case"br":return"<br />";default:return""}});var r,i,s,o=/!\[([^\]]*)\]\(((https?:\/\/)?((www\.)?[-a-zA-Z0-9@:%._\+~#=]{2,256}\.[a-z]{2,4}|localhost)\b([-a-zA-Z0-9@:%_\+.~#?&//=]*))\)/gim,a=/\[([^\]]*)\]\(((https?:\/\/)?((www\.)?[-a-zA-Z0-9@:%._\+~#=]{2,256}\.[a-z]{2,4}|localhost)\b([-a-zA-Z0-9@:%_\+.~#?&//=]*))\)/gim,g=!1,c=!1,u=0;let p=(e=(e=(e=e.replace(/<br[^>]*>/gim,"\n")).replace(/ +/gim," ")).replace(/\n{2,}/gim,"\n\n")).split(/\n/),h=[],d=[];for(let e=0;e<p.length;e++){let t=p[e].match(/^\s*-\s?([^\n]*)$/);p[e].match(/^\s*--/)&&(t=null),null!==t?h.push(t[1]):h.length&&(d.push({type:"ul",line_pos:e-h.length,items:h}),h=[])}h.length&&(d.push({type:"ul",line_pos:p.length-h.length,items:h}),h=[]);for(let e=0;e<p.length;e++){let t=p[e].match(/^\s*\d+[\.\)]\s?([^\n]*)$/);null!==t?h.push(t[1]):h.length&&(d.push({type:"ol",line_pos:e-h.length,items:h}),h=[])}h.length&&(d.push({type:"ol",line_pos:p.length-h.length,items:h}),h=[]),d.sort(((e,t)=>e.line_pos>t.line_pos?1:-1));for(let e=d.length;e--;)p.splice(d[e].line_pos,d[e].items.length),p[d[e].line_pos]=l(d[e].type,{},d[e].items)+(p[d[e].line_pos]||""),p[d[e].line_pos-1]&&(p[d[e].line_pos-1]+=p[d[e].line_pos],p.splice(d[e].line_pos,1));s=[...(e=p.join(l("br",{},null))).matchAll(/(https?:\/\/)?((www\.)?[-a-zA-Z0-9@:%._\+~#=]{2,256}\.[a-z]{2,4}|localhost)\b([-a-zA-Z0-9@:%_\+.~#?&//=]*)/gim)].reverse();e:for(let t=0;t<s.length;t++){if(!1!==(f=await n(s[t][0],"link"))){r=[...e.matchAll(a)].reverse();for(let e=0;e<r.length;e++)if(s[t].index>r[e].index&&s[t].index<r[e].index+r[e][0].length)continue e;i=[...e.matchAll(o)].reverse();for(let e=0;e<i.length;e++)if(s[t].index>i[e].index&&s[t].index<i[e].index+i[e][0].length)continue e;e=(e=e.substring(0,s[t].index+s[t][0].length)+")"+e.substring(s[t].index+s[t][0].length)).substring(0,s[t].index)+"["+s[t][0]+"]("+f+e.substring(s[t].index+s[t][0].length)}}for(;u>-1;)if((u=e.indexOf("```",u))>-1&&(!1===g?g=u:c=u,u+=3),!1!==g&&!1!==c){let t=l("br",{},null),n=e.substring(g+3,c);n.startsWith(t)&&(n=n.substring(t.length)),n.endsWith(t)&&(n=n.substring(0,n.length-t.length)),n=n.replaceAll(t,"\n"),n=n.replaceAll("<","&lt;"),n=n.replaceAll(">","&gt;");let r=l("pre",{},n);r=r.replaceAll("\n",t);let i=e.substring(0,g),s=e.substring(c+3).replace(/^\s*/,"");s.startsWith(t)&&(s=s.substring(t.length),s.startsWith(t)&&(s=s.substring(t.length))),e=i+r+s,u=g+r.length,g=!1,c=!1}for(g=!1,c=!1,u=0;u>-1;)if((u=e.indexOf("`",u))>-1&&(!1===g?g=u:c=u,u++),!1!==g&&!1!==c){let t=l("code",{},e.substring(g+1,c).replaceAll("<","&lt;").replaceAll(">","&gt;"));e=e.substring(0,g)+t+e.substring(c+1),u=g+t.length,g=!1,c=!1}for(g=!1,c=!1,u=0;u>-1;)if((u=e.indexOf("**",u))>-1&&(!1===g?g=u:c=u,u+=2),!1!==g&&!1!==c){let t=l("b",{},e.substring(g+2,c));e=e.substring(0,g)+t+e.substring(c+2),u=g+t.length,g=!1,c=!1}for(g=!1,c=!1,u=0;u>-1;)if((u=e.indexOf("*",u))>-1&&(!1===g?g=u:c=u,u++),!1!==g&&!1!==c){let t=l("i",{},e.substring(g+1,c));e=e.substring(0,g)+t+e.substring(c+1),u=g+t.length,g=!1,c=!1}i=[...e.matchAll(o)].reverse();for(let t=0;t<i.length;t++){if(!1===(f=await n(i[t][2],"image")))continue;let r=l("img",{src:f,alt:i[t][1]},null);e=e.substring(0,i[t].index)+r+e.substring(i[t].index+i[t][0].length)}r=[...e.matchAll(a)].reverse();for(let t=0;t<r.length;t++){var f;if(!1===(f=await n(r[t][2],"link")))continue;let i=l("a",{href:f},r[t][1]);e=e.substring(0,r[t].index)+i+e.substring(r[t].index+r[t][0].length)}return e}return e.r(t),e.d(t,{parse:()=>l}),t})()));
//# sourceMappingURL=simple-md-parser.min.js.map